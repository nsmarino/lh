{%- style -%}
    .collage-grid {
        display: grid;
        grid-template-rows: repeat(4, 25vw);
        grid-template-columns: repeat(4, minmax(0,1fr));
        width: 100vw;
    }
    .collage-grid.margined {
        width: calc(100vw - 1rem);
        margin: 0 auto;
        grid-template-rows: repeat(4, calc((100vw - 1rem) / 4));
    }
    .collage-grid.offset-bottom, .collage-grid.margined.offset-bottom {
        margin-bottom: -25vw;
    }
    .collage-grid img {
        width: 100%;
    }
    .mobile-col-start-1 {
        grid-column-start: 1;
    }
    .mobile-row-start-1 {
        grid-row-start: 1;
    }
    .mobile-col-start-2 {
        grid-column-start: 2;
    }
    .mobile-row-start-2 {
        grid-row-start: 2;
    }
    .mobile-col-start-3 {
        grid-column-start: 3;
    }
    .mobile-row-start-3 {
        grid-row-start: 3;
    }
    .mobile-span-1 {
        width: 25vw;
    }
    .mobile-span-2 {
        width: 50vw;
    }
    .mobile-span-3 {
        width: 75vw;
    }
    .mobile-span-4 {
        width: 100vw;
    }
    .margined .mobile-span-4 {
        width: calc(100vw - 1rem);
    }

    /* Mobile */
    @media screen and (max-width: 749px) {

    }

    /* Desktop */
    @media screen and (min-width: 750px) {
        .collage-grid {
            display: grid;
            grid-template-rows: repeat(8, 12.5vw);
            grid-template-columns: repeat(8, minmax(0,1fr));
            width: 100vw;
        }
        .collage-grid.margined {
            width: calc(100vw - 2rem);
            margin: 0 auto;
            grid-template-rows: repeat(8, calc((100vw - 2rem) / 8));
        }

        /* Unset all mobile classes: */
        .mobile-col-start-1, .mobile-col-start-2, .mobile-col-start-3 {
            grid-column-start: unset;
        }
        .mobile-row-start-1, .mobile-row-start-2, .mobile-row-start-3 {
            grid-row-start: unset;
        }
        .mobile-span-1, .mobile-span-2, .mobile-span-3 {
            width: unset;
        }

        /* Now apply desktop classes */
        .desktop-col-start-1 {
            grid-column-start: 1;
        }
        .desktop-col-start-2 {
            grid-column-start: 2;
        }
        .desktop-col-start-3 {
            grid-column-start: 3;
        }
        .desktop-col-start-4 {
            grid-column-start: 4;
        }
        .desktop-col-start-5 {
            grid-column-start: 5;
        }
        .desktop-col-start-6 {
            grid-column-start: 6;
        }
        .desktop-col-start-7 {
            grid-column-start: 7;
        }

        .desktop-row-start-1 {
            grid-row-start: 1;
        }
        .desktop-row-start-2 {
            grid-row-start: 2;
        }
        .desktop-row-start-3 {
            grid-row-start: 3;
        }
        .desktop-row-start-4 {
            grid-row-start: 4;
        }
        .desktop-row-start-5 {
            grid-row-start: 5;
        }
        .desktop-row-start-6 {
            grid-row-start: 6;
        }
        .desktop-row-start-7 {
            grid-row-start: 7;
        }
        .desktop-span-1 {
            width: 12.5vw;
        }
        .desktop-span-2 {
            width: 25vw;
        }
        .desktop-span-3 {
            width: 37.5vw;
        }
        .desktop-span-4 {
            width: 50vw;
        }
        .desktop-span-5 {
            width: 62.5vw;
        }
        .desktop-span-6 {
            width: 75vw;
        }
        .desktop-span-7 {
            width: 87.5vw;
        }
    }
{%- endstyle -%}

<div class="collage-grid {% if section.settings.offset_bottom == true %} offset-bottom {% endif %} {% if section.settings.margin == true %} margined {% endif %}">
    {% for block in section.blocks %}
        <div style="transform: rotate({{ block.settings.rotation }}deg) scale({{ block.settings.scale }});" class="{{ block.settings.mobile_col_start }} {{ block.settings.mobile_row_start }} {{ block.settings.mobile_span }} {{ block.settings.desktop_col_start }} {{ block.settings.desktop_row_start }} {{ block.settings.desktop_span }}">
        {% if block.settings.link != blank %}<a href="{{ block.settings.link }}">{% endif %}
            {% if block.settings.image != blank %}
                <img src="{{ block.settings.image |  image_url  }}" alt="">
            {% endif %}
            {% if block.settings.link_label != blank %}
                <p>{{ block.settings.link_label }}</p>
            {% endif %}
            {% if block.settings.text != blank %}
                <div>{{ block.settings.text }}</div>
            {% endif %}
        {% if block.settings.link != blank %}</a>{% endif %}
        </div>
    {% endfor %}
</div>

{% schema %}
{
  "name": "Collage Grid",
  "class": "section",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "margin",
      "default": false,
      "label": "Side Margins",
      "info": "Toggle to use page margins"
    },
    {
      "type": "checkbox",
      "id": "offset_bottom",
      "default": false,
      "label": "Offset Bottom",
      "info": "Toggle to blend together different Collage Grid sections"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.multicolumn.blocks.column.settings.image.label"
        },
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Pair text with an image to focus on your chosen product, collection, or blog post. Add details on availability, style, or even provide a review.</p>",
          "label": "t:sections.multicolumn.blocks.column.settings.text.label"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "t:sections.multicolumn.blocks.column.settings.link_label.label"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:sections.multicolumn.blocks.column.settings.link.label"
        },
        {
            "type": "select",
            "id": "mobile_col_start",
            "options": [
                {
                "value": "mobile-col-start-1",
                "label": "1"
                },
                {
                "value": "mobile-col-start-2",
                "label": "2"
                },
                {
                "value": "mobile-col-start-3",
                "label": "3"
                }
            ],
            "default": "mobile-col-start-1",
            "label": "Column Start (mobile)"
        },
        {
            "type": "select",
            "id": "mobile_row_start",
            "options": [
                {
                "value": "mobile-row-start-1",
                "label": "1"
                },
                {
                "value": "mobile-row-start-2",
                "label": "2"
                },
                {
                "value": "mobile-row-start-3",
                "label": "3"
                }
            ],
            "default": "mobile-row-start-1",
            "label": "Row Start (mobile)"
        },
        {
            "type": "select",
            "id": "mobile_span",
            "options": [
                {
                "value": "mobile-span-1",
                "label": "1"
                },
                {
                "value": "mobile-span-2",
                "label": "2"
                },
                {
                "value": "mobile-span-3",
                "label": "3"
                },
                {
                "value": "mobile-span-4",
                "label": "4"
                }
            ],
            "default": "mobile-span-1",
            "label": "Width (mobile)"
        },
        {
            "type": "select",
            "id": "desktop_col_start",
            "options": [
                {
                "value": "desktop-col-start-1",
                "label": "1"
                },
                {
                "value": "desktop-col-start-2",
                "label": "2"
                },
                {
                "value": "desktop-col-start-3",
                "label": "3"
                },
                {
                "value": "desktop-col-start-4",
                "label": "4"
                },
                {
                "value": "desktop-col-start-5",
                "label": "5"
                },
                {
                "value": "desktop-col-start-6",
                "label": "6"
                },
                {
                "value": "desktop-col-start-7",
                "label": "7"
                }
            ],
            "default": "desktop-col-start-1",
            "label": "Column Start (desktop)"
        },
        {
            "type": "select",
            "id": "desktop_row_start",
            "options": [
                {
                "value": "desktop_row_start-1",
                "label": "1"
                },
                {
                "value": "desktop_row_start-2",
                "label": "2"
                },
                {
                "value": "desktop_row_start-3",
                "label": "3"
                },
                {
                "value": "desktop_row_start-4",
                "label": "4"
                },
                {
                "value": "desktop_row_start-5",
                "label": "5"
                },
                {
                "value": "desktop_row_start-6",
                "label": "6"
                },
                {
                "value": "desktop_row_start-7",
                "label": "7"
                }
            ],
            "default": "desktop_row_start-1",
            "label": "Row Start (desktop)"
        },
        {
            "type": "select",
            "id": "desktop_span",
            "options": [
                {
                "value": "desktop-span-1",
                "label": "1"
                },
                {
                "value": "desktop-span-2",
                "label": "2"
                },
                {
                "value": "desktop-span-3",
                "label": "3"
                },
                {
                "value": "desktop-span-4",
                "label": "4"
                },
                {
                "value": "desktop-span-5",
                "label": "5"
                },
                {
                "value": "desktop-span-6",
                "label": "6"
                },
                {
                "value": "desktop-span-7",
                "label": "7"
                }
            ],
            "default": "desktop-span-1",
            "label": "Width (desktop)"
        },
        {
            "type": "select",
            "id": "entrance-anim",
            "options": [
                {
                "value": "fly",
                "label": "Fly"
                },
                {
                "value": "Wipe",
                "label": "Wipe"
                }
            ],
            "default": "fly",
            "label": "Entrance Anim"
        },
        {
            "type": "range",
            "id": "rotation",
            "min": -90,
            "max": 90,
            "step": 5,
            "default": 0,
            "unit": "deg",
            "label": "Rotation"
        },
        {
            "type": "range",
            "id": "scale",
            "min": 0.8,
            "max": 1.2,
            "step": 0.1,
            "default": 1,
            "label": "Scale",
            "info": "Slightly tweak scale to make gridded elements appear more dynamic."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collage Grid",
      "blocks": [
        {
          "type": "card"
        },
        {
          "type": "card"
        }
      ]
    }
  ]
}
{% endschema %}
