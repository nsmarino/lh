{%- style -%}
    [data-entrance="wipe"] {
        opacity: 0;
        transform: rotate(var(--rotate)) scale(var(--scale)) translateY(100px);
    }

    [data-entrance="fly"] {
        opacity: 0;
        transform: rotate(var(--rotate)) scale(var(--scale)) translateY(100px);
    }

    [data-entrance="wipe"].active {
        transition: 0.8s ease all;
        transform: rotate(var(--rotate)) scale(var(--scale)) translateY(0px);
        opacity: 1;
    }

    [data-entrance="fly"].active {
        transition: 1.4s ease all;
        transform: rotate(var(--rotate)) scale(var(--scale)) translateY(0px);
        opacity: 1;
    }

    .collage-grid {
        display: grid;
        grid-template-columns: repeat(8, minmax(0,1fr));
        width: 100vw;
        /* overflow-x: hidden; */
        /* overflow-y: visible; */
    }
    .mobile-spacer {
        width: 100vw;
        height: calc(100vw / 8);
    }
    .collage-grid a {
        text-decoration: none;
    }
    .collage-grid a:hover {
        font-style: italic;
    }

    .collage-grid.auto-rows-mobile {
        grid-template-rows: auto;
    }

    .collage-grid img {
        width: 100%;
        height: auto;
    }
    .mobile-col-start-1 {
        grid-column-start: 1;
    }
    .mobile-row-start-1 {
        grid-row-start: 1;
    }
    .mobile-col-start-2 {
        grid-column-start: 2;
    }
    .mobile-row-start-2 {
        grid-row-start: 2;
    }
    .mobile-col-start-3 {
        grid-column-start: 3;
    }
    .mobile-row-start-3 {
        grid-row-start: 3;
    }
    .mobile-col-start-4 {
        grid-column-start: 4;
    }
    .mobile-row-start-4 {
        grid-row-start: 4;
    }
    .mobile-col-start-5 {
        grid-column-start: 5;
    }
    .mobile-row-start-5 {
        grid-row-start: 5;
    }
    .mobile-col-start-6 {
        grid-column-start: 6;
    }
    .mobile-row-start-6 {
        grid-row-start: 6;
    }
    .mobile-col-start-7 {
        grid-column-start: 7;
    }
    .mobile-row-start-7 {
        grid-row-start: 7;
    }
    .mobile-span-1 {
        width: 12.5vw;
    }
    .mobile-span-2 {
        width: 25vw;
    }
    .mobile-span-3 {
        width: 37.5vw;
    }
    .mobile-span-4 {
        width: 50vw;
    }
    .mobile-span-5 {
        width: 62.5vw;
    }
    .mobile-span-6 {
        width: 75vw;
    }
    .mobile-span-7 {
        width: 87.5vw;
    }
    .mobile-span-8 {
        width: 100vw;
    }

    .link-label {
        text-align: center;
        font-size: 1.4rem;
        line-height: 115%;
        letter-spacing: 0.14px;
        text-transform: uppercase;
        color: black;
        text-decoration: underline;
        text-underline-offset: 4px;
    }
    .text-block {
        padding: 0 1em;
        text-transform: uppercase;
        font-family: 'Marfa-Thin';
        font-size: 1.6rem;
        line-height: 110%;
        letter-spacing: 1.5px;
    }
    /* Mobile */
    @media screen and (max-width: 749px) {
        .text-block {
            display: none;
        }
    }

    /* Desktop */
    @media screen and (min-width: 750px) {
        .mobile-spacer {
            display: none;
        }
        .collage-grid.offset-bottom {
            margin-bottom: -8.33vw;
        }
        /* Unset all mobile classes: */
        .collage-grid.auto-rows-mobile {
            grid-template-rows: unset;
        }
        .mobile-col-start-1, .mobile-col-start-2, .mobile-col-start-3,  .mobile-col-start-4,  .mobile-col-start-5,  .mobile-col-start-6,  .mobile-col-start-7 {
            grid-column-start: unset;
        }
        .mobile-row-start-1, .mobile-row-start-2, .mobile-row-start-3, .mobile-row-start-4, .mobile-row-start-5, .mobile-row-start-6, .mobile-row-start-7 {
            grid-row-start: unset;
        }
        .mobile-span-1, .mobile-span-2, .mobile-span-3, .mobile-span-4, .mobile-span-5, .mobile-span-6, .mobile-span-7, .mobile-span-8 {
            width: unset;
        }

        /* Now apply desktop classes */
        .collage-grid, .collage-grid.auto-rows-mobile {
            display: grid;
            grid-template-rows: repeat(12, calc(100vw / 12));
            grid-template-columns: repeat(12, minmax(0,1fr));
            width: 100vw;
        }

        .desktop-col-start-1 {
            grid-column-start: 1;
        }
        .desktop-col-start-2 {
            grid-column-start: 2;
        }
        .desktop-col-start-3 {
            grid-column-start: 3;
        }
        .desktop-col-start-4 {
            grid-column-start: 4;
        }
        .desktop-col-start-5 {
            grid-column-start: 5;
        }
        .desktop-col-start-6 {
            grid-column-start: 6;
        }
        .desktop-col-start-7 {
            grid-column-start: 7;
        }
        .desktop-col-start-8 {
            grid-column-start: 8;
        }
        .desktop-col-start-9 {
            grid-column-start: 9;
        }
        .desktop-col-start-10 {
            grid-column-start: 10;
        }
        .desktop-col-start-11 {
            grid-column-start: 11;
        }

        .desktop-row-start-1 {
            grid-row-start: 1;
        }
        .desktop-row-start-2 {
            grid-row-start: 2;
        }
        .desktop-row-start-3 {
            grid-row-start: 3;
        }
        .desktop-row-start-4 {
            grid-row-start: 4;
        }
        .desktop-row-start-5 {
            grid-row-start: 5;
        }
        .desktop-row-start-6 {
            grid-row-start: 6;
        }
        .desktop-row-start-7 {
            grid-row-start: 7;
        }
        .desktop-row-start-8 {
            grid-row-start: 8;
        }
        .desktop-row-start-9 {
            grid-row-start: 9;
        }
        .desktop-row-start-10 {
            grid-row-start: 10;
        }
        .desktop-row-start-11 {
            grid-row-start: 11;
        }
        .desktop-span-1 {
            width: calc((100vw / 12));
        }
        .desktop-span-2 {
            width: calc((100vw / 12) * 2);
        }
        .desktop-span-3 {
            width: calc((100vw / 12) * 3);
        }
        .desktop-span-4 {
            width: calc((100vw / 12) * 4);
        }
        .desktop-span-5 {
            width: calc((100vw / 12) * 5);
        }
        .desktop-span-6 {
            width: calc((100vw / 12) * 6);
        }
        .desktop-span-7 {
            width: calc((100vw / 12) * 7);
        }
        .desktop-span-8 {
            width: calc((100vw / 12) * 8);
        }
        .desktop-span-9 {
            width: calc((100vw / 12) * 9);
        }
        .desktop-span-10 {
            width: calc((100vw / 12) * 10);
        }
        .desktop-span-11 {
            width: calc((100vw / 12) * 11);
        }
    }
{%- endstyle -%}

<div class="collage-grid {% if section.settings.offset_bottom == true %} offset-bottom {% endif %} auto-rows-mobile">
    {% for block in section.blocks %}
        {% case block.type %}
        {% when "card" %}
            <div data-entrance="{{ block.settings.entrance-anim }}" style="--rotate: {{ block.settings.rotation }}deg; --scale: {{ block.settings.scale }};" class="{{ block.settings.mobile_col_start }} {{ block.settings.mobile_row_start }} {{ block.settings.mobile_span }} {{ block.settings.desktop_col_start }} {{ block.settings.desktop_row_start }} {{ block.settings.desktop_span }}">
                {% if block.settings.link != blank %}<a href="{{ block.settings.link }}">{% endif %}
                    {% if block.settings.image != blank %}
                        {% comment %} <img src="{{ block.settings.image |  image_url  }}" alt=""> {% endcomment %}
                        <img
                        srcset="
                        {%- if block.settings.image.width >= 375 -%}{{ block.settings.image | image_url: width: 375 }} 375w,{%- endif -%}
                        {%- if block.settings.image.width >= 750 -%}{{ block.settings.image | image_url: width: 750 }} 750w,{%- endif -%}
                        {%- if block.settings.image.width >= 1100 -%}{{ block.settings.image | image_url: width: 1100 }} 1100w,{%- endif -%}
                        {%- if block.settings.image.width >= 1500 -%}{{ block.settings.image | image_url: width: 1500 }} 1500w,{%- endif -%}
                        {%- if block.settings.image.width >= 1780 -%}{{ block.settings.image | image_url: width: 1780 }} 1780w,{%- endif -%}
                        {%- if block.settings.image.width >= 2000 -%}{{ block.settings.image | image_url: width: 2000 }} 2000w,{%- endif -%}
                        {%- if block.settings.image.width >= 3000 -%}{{ block.settings.image | image_url: width: 3000 }} 3000w,{%- endif -%}
                        {%- if block.settings.image.width >= 3840 -%}{{ block.settings.image | image_url: width: 3840 }} 3840w,{%- endif -%}
                        {{ block.settings.image | image_url }} {{ block.settings.image.width }}w
                        "
                        sizes="100vw"
                        src="{{ block.settings.image | image_url: width: 1500 }}"
                        loading="lazy"
                        alt="{{ block.settings.image.alt | escape }}"
                        width="{{ block.settings.image.width }}"
                        height="{{ block.settings.image.width | divided_by: block.settings.image.aspect_ratio }}"
                    >
                    {% endif %}
                    {% if block.settings.link_label != blank %}
                        <p class="link-label">{{ block.settings.link_label }}</p>
                    {% endif %}
                    {% if block.settings.text != blank %}
                        <div class="text-block">{{ block.settings.text }}</div>
                    {% endif %}
                {% if block.settings.link != blank %}</a>{% endif %}
            </div>
        {% when "spacer" %}
            <div class="mobile-spacer {{ block.settings.mobile_row_start }}"></div>
        {% endcase %}
    {% endfor %}
</div>

{% schema %}
{
  "name": "Collage Grid",
  "class": "section",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "offset_bottom",
      "default": false,
      "label": "Desktop Offset",
      "info": "Used to blend together different Collage Grid sections"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.multicolumn.blocks.column.settings.image.label"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Image alt text"
        },
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Collage grid item</p>",
          "label": "Lyric Block"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "t:sections.multicolumn.blocks.column.settings.link_label.label"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:sections.multicolumn.blocks.column.settings.link.label"
        },
        {
            "type": "select",
            "id": "mobile_col_start",
            "options": [
                {
                "value": "mobile-col-start-1",
                "label": "1"
                },
                {
                "value": "mobile-col-start-2",
                "label": "2"
                },
                {
                "value": "mobile-col-start-3",
                "label": "3"
                },
                {
                "value": "mobile-col-start-4",
                "label": "4"
                },
                {
                "value": "mobile-col-start-5",
                "label": "5"
                },
                {
                "value": "mobile-col-start-6",
                "label": "6"
                },
                {
                "value": "mobile-col-start-7",
                "label": "7"
                }
            ],
            "default": "mobile-col-start-1",
            "label": "Column Start (mobile)"
        },
        {
            "type": "select",
            "id": "mobile_row_start",
            "options": [
                {
                "value": "mobile-row-start-1",
                "label": "1"
                },
                {
                "value": "mobile-row-start-2",
                "label": "2"
                },
                {
                "value": "mobile-row-start-3",
                "label": "3"
                },
                {
                "value": "mobile-row-start-4",
                "label": "4"
                },
                {
                "value": "mobile-row-start-5",
                "label": "5"
                },
                {
                "value": "mobile-row-start-6",
                "label": "6"
                },
                {
                "value": "mobile-row-start-7",
                "label": "7"
                }
            ],
            "default": "mobile-row-start-1",
            "label": "Row Start (mobile)"
        },
        {
            "type": "select",
            "id": "mobile_span",
            "options": [
                {
                "value": "mobile-span-1",
                "label": "1"
                },
                {
                "value": "mobile-span-2",
                "label": "2"
                },
                {
                "value": "mobile-span-3",
                "label": "3"
                },
                {
                "value": "mobile-span-4",
                "label": "4"
                },
                {
                "value": "mobile-span-5",
                "label": "5"
                },
                {
                "value": "mobile-span-6",
                "label": "6"
                },
                {
                "value": "mobile-span-7",
                "label": "7"
                },
                {
                "value": "mobile-span-8",
                "label": "8"
                }
            ],
            "default": "mobile-span-1",
            "label": "Width (mobile)"
        },
        {
            "type": "select",
            "id": "desktop_col_start",
            "options": [
                {
                "value": "desktop-col-start-1",
                "label": "1"
                },
                {
                "value": "desktop-col-start-2",
                "label": "2"
                },
                {
                "value": "desktop-col-start-3",
                "label": "3"
                },
                {
                "value": "desktop-col-start-4",
                "label": "4"
                },
                {
                "value": "desktop-col-start-5",
                "label": "5"
                },
                {
                "value": "desktop-col-start-6",
                "label": "6"
                },
                {
                "value": "desktop-col-start-7",
                "label": "7"
                },
                {
                "value": "desktop-col-start-8",
                "label": "8"
                },
                {
                "value": "desktop-col-start-9",
                "label": "9"
                },
                {
                "value": "desktop-col-start-10",
                "label": "10"
                },
                {
                "value": "desktop-col-start-11",
                "label": "11"
                }
            ],
            "default": "desktop-col-start-1",
            "label": "Column Start (desktop)"
        },
        {
            "type": "select",
            "id": "desktop_row_start",
            "options": [
                {
                "value": "desktop-row-start-1",
                "label": "1"
                },
                {
                "value": "desktop-row-start-2",
                "label": "2"
                },
                {
                "value": "desktop-row-start-3",
                "label": "3"
                },
                {
                "value": "desktop-row-start-4",
                "label": "4"
                },
                {
                "value": "desktop-row-start-5",
                "label": "5"
                },
                {
                "value": "desktop-row-start-6",
                "label": "6"
                },
                {
                "value": "desktop-row-start-7",
                "label": "7"
                },
                {
                "value": "desktop-row-start-8",
                "label": "8"
                },
                {
                "value": "desktop-row-start-9",
                "label": "9"
                },
                {
                "value": "desktop-row-start-10",
                "label": "10"
                },
                {
                "value": "desktop-row-start-11",
                "label": "11"
                }
            ],
            "default": "desktop-row-start-1",
            "label": "Row Start (desktop)"
        },
        {
            "type": "select",
            "id": "desktop_span",
            "options": [
                {
                "value": "desktop-span-1",
                "label": "1"
                },
                {
                "value": "desktop-span-2",
                "label": "2"
                },
                {
                "value": "desktop-span-3",
                "label": "3"
                },
                {
                "value": "desktop-span-4",
                "label": "4"
                },
                {
                "value": "desktop-span-5",
                "label": "5"
                },
                {
                "value": "desktop-span-6",
                "label": "6"
                },
                {
                "value": "desktop-span-7",
                "label": "7"
                },
                {
                "value": "desktop-span-8",
                "label": "8"
                },
                {
                "value": "desktop-span-9",
                "label": "9"
                },
                {
                "value": "desktop-span-10",
                "label": "10"
                },
                {
                "value": "desktop-span-11",
                "label": "11"
                }
            ],
            "default": "desktop-span-1",
            "label": "Width (desktop)"
        },
        {
            "type": "select",
            "id": "entrance-anim",
            "options": [
                {
                "value": "fly",
                "label": "Slow Fly"
                },
                {
                "value": "wipe",
                "label": "Fast Fly"
                }
            ],
            "default": "fly",
            "label": "Entrance Anim"
        },
        {
            "type": "range",
            "id": "rotation",
            "min": -20,
            "max": 20,
            "step": 1,
            "default": 0,
            "unit": "deg",
            "label": "Rotation"
        },
        {
            "type": "range",
            "id": "scale",
            "min": 0.8,
            "max": 1.2,
            "step": 0.1,
            "default": 1,
            "label": "Scale",
            "info": "Slightly tweak scale to make gridded elements appear more dynamic."
        }
      ]
    },
    {
      "type": "spacer",
      "name": "Mobile Spacer",
      "settings": [
        {
            "type": "select",
            "id": "mobile_row_start",
            "options": [
                {
                "value": "mobile-row-start-1",
                "label": "1"
                },
                {
                "value": "mobile-row-start-2",
                "label": "2"
                },
                {
                "value": "mobile-row-start-3",
                "label": "3"
                },
                {
                "value": "mobile-row-start-4",
                "label": "4"
                },
                {
                "value": "mobile-row-start-5",
                "label": "5"
                },
                {
                "value": "mobile-row-start-6",
                "label": "6"
                },
                {
                "value": "mobile-row-start-7",
                "label": "7"
                }
            ],
            "default": "mobile-row-start-1",
            "label": "Row Start (mobile)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collage Grid",
      "blocks": [
        {
          "type": "card"
        },
        {
          "type": "card"
        }
      ]
    }
  ]
}
{% endschema %}
